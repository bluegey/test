#include "OLED.h"
#include "mydelay.h"
#include "stdio.h"
#include "stdarg.h"


/**************************************************************************************************
 *                                          CONSTANTS
 **************************************************************************************************/
/* LCD Control lines */
//  PC_4 - OLED_DC
//  PC_5 - OLED_RES
//  ???? - OLED_CS
//  PA_15- OLED_CLK
//  PA_8 - OLED_DAT

#define FONT_CS_LOW()        	GPIO_ResetBits(GPIOA, GPIO_Pin_4)
#define FONT_CS_HIGH()       	GPIO_SetBits(GPIOA, GPIO_Pin_4)

#define OLED_CS_LOW()       	GPIO_ResetBits(GPIOC, GPIO_Pin_5)
#define OLED_CS_HIGH()      	GPIO_SetBits(GPIOC, GPIO_Pin_5)

#define OLED_DC_LOW()       	GPIO_ResetBits(GPIOC, GPIO_Pin_4)
#define OLED_DC_HIGH()      	GPIO_SetBits(GPIOC, GPIO_Pin_4)

/**************************************************************************************************
 *                                           MACROS
 **************************************************************************************************/


/**************************************************************************************************
 *                                       LOCAL VARIABLES
 **************************************************************************************************/
const unsigned char OLED_HiASCII[128][16]={
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x80,0x80,0x80},/*"",1*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0xFF,0x00,0x00,0x00},/*"",2*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80},/*"",3*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x00},/*"",4*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00},/*"",5*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80},/*"",6*/
{0x00,0x03,0x07,0x0F,0x0F,0x07,0x03,0x00,0x00,0x80,0xC0,0xE0,0xE0,0xC0,0x80,0x00},/*"",7*/
{0xFF,0xFC,0xF8,0xF0,0xF0,0xF8,0xFC,0xFF,0xFF,0x7F,0x3F,0x1F,0x1F,0x3F,0x7F,0xFF},/*"",8*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"	",9*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",10*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",11*/
{0x00,0x00,0x00,0x21,0x26,0x38,0x20,0x3E,0x00,0x38,0x44,0xC4,0x44,0x38,0x00,0x00},/*"",12*/
{0x00,0x00,0x1C,0x22,0x23,0x22,0x1C,0x00,0x00,0x40,0x40,0x40,0xFC,0x40,0x40,0x40},/*"",13*/
{0x00,0x00,0x00,0x3F,0x24,0x24,0x48,0x7F,0x00,0x0C,0x1C,0xF8,0x00,0x30,0x70,0xE0},/*"",14*/
{0x00,0x11,0x0F,0x10,0x70,0x10,0x0F,0x11,0x00,0x10,0xE0,0x10,0x1C,0x10,0xE0,0x10},/*"",15*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0xFF,0x80,0x80,0x80},/*"",16*/
{0x00,0x00,0x01,0x03,0x07,0x0F,0x1F,0x3F,0x00,0x80,0xC0,0xE0,0xF0,0xF8,0xFC,0xFE},/*"",17*/
{0x00,0x00,0x10,0x20,0x7F,0x20,0x10,0x00,0x00,0x00,0x08,0x04,0xFE,0x04,0x08,0x00},/*"",18*/
{0x00,0x00,0x3F,0x00,0x00,0x3F,0x00,0x00,0x00,0x00,0xE6,0x00,0x00,0xE6,0x00,0x00},/*"",19*/
{0x00,0x0E,0x11,0x20,0x20,0x3F,0x20,0x3F,0x00,0x00,0x00,0x80,0x80,0xFC,0x00,0xFC},/*"",20*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80},/*"",21*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0xFF,0x80,0x80,0x80},/*"",22*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0xFF,0x00,0x00,0x00},/*"",23*/
{0x00,0x00,0x10,0x20,0x7F,0x20,0x10,0x00,0x00,0x00,0x00,0x00,0xFE,0x00,0x00,0x00},/*"",24*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x80,0x80,0x80},/*"",25*/
{0x00,0x00,0x00,0x00,0x00,0x02,0x01,0x00,0x00,0x80,0x80,0x80,0x80,0xA0,0xC0,0x80},
{0x00,0x00,0x01,0x02,0x00,0x00,0x00,0x00,0x00,0x80,0xC0,0xA0,0x80,0x80,0x80,0x80},/*"",27*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"",28*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"",29*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"",30*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"",31*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",32*/
{0x00,0x00,0x00,0x1F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xCC,0x0C,0x00,0x00,0x00},/*"!",33*/
{0x00,0x08,0x30,0x60,0x08,0x30,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*""",34*/
{0x02,0x03,0x1E,0x02,0x03,0x1E,0x02,0x00,0x20,0xFC,0x20,0x20,0xFC,0x20,0x20,0x00},/*"#",35*/
{0x00,0x0E,0x11,0x3F,0x10,0x0C,0x00,0x00,0x00,0x18,0x04,0xFF,0x84,0x78,0x00,0x00},/*"$",36*/
{0x0F,0x10,0x0F,0x00,0x07,0x18,0x00,0x00,0x00,0x84,0x38,0xC0,0x78,0x84,0x78,0x00},/*"%",37*/
{0x00,0x0F,0x10,0x11,0x0E,0x00,0x00,0x00,0x78,0x84,0xC4,0x24,0x98,0xE4,0x84,0x08},/*"&",38*/
{0x08,0x68,0x70,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",39*/
{0x00,0x00,0x00,0x07,0x18,0x20,0x40,0x00,0x00,0x00,0x00,0xE0,0x18,0x04,0x02,0x00},/*"(",40*/
{0x00,0x40,0x20,0x18,0x07,0x00,0x00,0x00,0x00,0x02,0x04,0x18,0xE0,0x00,0x00,0x00},/*")",41*/
{0x02,0x02,0x01,0x0F,0x01,0x02,0x02,0x00,0x40,0x40,0x80,0xF0,0x80,0x40,0x40,0x00},/*"*",42*/
{0x00,0x00,0x00,0x0F,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0xF8,0x80,0x80,0x80,0x00},/*"+",43*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x0D,0x0E,0x00,0x00,0x00,0x00,0x00},/*",",44*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80},/*"-",45*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x0C,0x00,0x00,0x00,0x00,0x00},/*".",46*/
{0x00,0x00,0x00,0x00,0x01,0x06,0x18,0x20,0x00,0x06,0x18,0x60,0x80,0x00,0x00,0x00},/*"/",47*/
{0x00,0x07,0x08,0x10,0x10,0x08,0x07,0x00,0x00,0xF0,0x08,0x04,0x04,0x08,0xF0,0x00},/*"0",48*/
{0x00,0x08,0x08,0x1F,0x00,0x00,0x00,0x00,0x00,0x04,0x04,0xFC,0x04,0x04,0x00,0x00},/*"1",49*/
{0x00,0x0E,0x10,0x10,0x10,0x11,0x0E,0x00,0x00,0x0C,0x14,0x24,0x44,0x84,0x0C,0x00},/*"2",50*/
{0x00,0x0C,0x10,0x11,0x11,0x12,0x0C,0x00,0x00,0x18,0x04,0x04,0x04,0x88,0x70,0x00},/*"3",51*/
{0x00,0x00,0x03,0x04,0x08,0x1F,0x00,0x00,0x00,0xE0,0x20,0x24,0x24,0xFC,0x24,0x00},/*"4",52*/
{0x00,0x1F,0x10,0x11,0x11,0x10,0x10,0x00,0x00,0x98,0x84,0x04,0x04,0x88,0x70,0x00},/*"5",53*/
{0x00,0x07,0x08,0x11,0x11,0x18,0x00,0x00,0x00,0xF0,0x88,0x04,0x04,0x88,0x70,0x00},/*"6",54*/
{0x00,0x1C,0x10,0x10,0x13,0x1C,0x10,0x00,0x00,0x00,0x00,0xFC,0x00,0x00,0x00,0x00},/*"7",55*/
{0x00,0x0E,0x11,0x10,0x10,0x11,0x0E,0x00,0x00,0x38,0x44,0x84,0x84,0x44,0x38,0x00},/*"8",56*/
{0x00,0x07,0x08,0x10,0x10,0x08,0x07,0x00,0x00,0x00,0x8C,0x44,0x44,0x88,0xF0,0x00},/*"9",57*/
{0x00,0x00,0x00,0x03,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x0C,0x00,0x00,0x00},/*":",58*/
{0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x06,0x00,0x00,0x00,0x00},/*";",59*/
{0x00,0x00,0x01,0x02,0x04,0x08,0x10,0x00,0x00,0x80,0x40,0x20,0x10,0x08,0x04,0x00},/*"<",60*/
{0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},/*"=",61*/
{0x00,0x10,0x08,0x04,0x02,0x01,0x00,0x00,0x00,0x04,0x08,0x10,0x20,0x40,0x80,0x00},/*">",62*/
{0x00,0x0E,0x12,0x10,0x10,0x10,0x0F,0x00,0x00,0x00,0x00,0x0C,0x6C,0x80,0x00,0x00},/*"?",63*/
{0x03,0x0C,0x13,0x14,0x17,0x08,0x07,0x00,0xE0,0x18,0xE4,0x24,0xC4,0x28,0xD0,0x00},/*"@",64*/
{0x00,0x00,0x03,0x1C,0x07,0x00,0x00,0x00,0x04,0x3C,0xC4,0x40,0x40,0xE4,0x1C,0x04},/*"A",65*/
{0x10,0x1F,0x11,0x11,0x11,0x0E,0x00,0x00,0x04,0xFC,0x04,0x04,0x04,0x88,0x70,0x00},/*"B",66*/
{0x03,0x0C,0x10,0x10,0x10,0x10,0x1C,0x00,0xE0,0x18,0x04,0x04,0x04,0x08,0x10,0x00},/*"C",67*/
{0x10,0x1F,0x10,0x10,0x10,0x08,0x07,0x00,0x04,0xFC,0x04,0x04,0x04,0x08,0xF0,0x00},/*"D",68*/
{0x10,0x1F,0x11,0x11,0x17,0x10,0x08,0x00,0x04,0xFC,0x04,0x04,0xC4,0x04,0x18,0x00},/*"E",69*/
{0x10,0x1F,0x11,0x11,0x17,0x10,0x08,0x00,0x04,0xFC,0x04,0x00,0xC0,0x00,0x00,0x00},/*"F",70*/
{0x03,0x0C,0x10,0x10,0x10,0x1C,0x00,0x00,0xE0,0x18,0x04,0x04,0x44,0x78,0x40,0x00},/*"G",71*/
{0x10,0x1F,0x10,0x00,0x00,0x10,0x1F,0x10,0x04,0xFC,0x84,0x80,0x80,0x84,0xFC,0x04},/*"H",72*/
{0x00,0x10,0x10,0x1F,0x10,0x10,0x00,0x00,0x00,0x04,0x04,0xFC,0x04,0x04,0x00,0x00},/*"I",73*/
{0x00,0x00,0x10,0x10,0x1F,0x10,0x10,0x00,0x03,0x01,0x01,0x01,0xFE,0x00,0x00,0x00},/*"J",74*/
{0x10,0x1F,0x11,0x03,0x14,0x18,0x10,0x00,0x04,0xFC,0x04,0x80,0x64,0x1C,0x04,0x00},/*"K",75*/
{0x10,0x1F,0x10,0x00,0x00,0x00,0x00,0x00,0x04,0xFC,0x04,0x04,0x04,0x04,0x0C,0x00},/*"L",76*/
{0x10,0x1F,0x1F,0x00,0x1F,0x1F,0x10,0x00,0x04,0xFC,0x00,0xFC,0x00,0xFC,0x04,0x00},/*"M",77*/
{0x10,0x1F,0x0C,0x03,0x00,0x10,0x1F,0x10,0x04,0xFC,0x04,0x00,0xE0,0x18,0xFC,0x00},/*"N",78*/
{0x07,0x08,0x10,0x10,0x10,0x08,0x07,0x00,0xF0,0x08,0x04,0x04,0x04,0x08,0xF0,0x00},/*"O",79*/
{0x10,0x1F,0x10,0x10,0x10,0x10,0x0F,0x00,0x04,0xFC,0x84,0x80,0x80,0x80,0x00,0x00},/*"P",80*/
{0x07,0x08,0x10,0x10,0x10,0x08,0x07,0x00,0xF0,0x18,0x24,0x24,0x1C,0x0A,0xF2,0x00},/*"Q",81*/
{0x10,0x1F,0x11,0x11,0x11,0x11,0x0E,0x00,0x04,0xFC,0x04,0x00,0xC0,0x30,0x0C,0x04},/*"R",82*/
{0x00,0x0E,0x11,0x10,0x10,0x10,0x1C,0x00,0x00,0x1C,0x04,0x84,0x84,0x44,0x38,0x00},/*"S",83*/
{0x18,0x10,0x10,0x1F,0x10,0x10,0x18,0x00,0x00,0x00,0x04,0xFC,0x04,0x00,0x00,0x00},/*"T",84*/
{0x10,0x1F,0x10,0x00,0x00,0x10,0x1F,0x10,0x00,0xF8,0x04,0x04,0x04,0x04,0xF8,0x00},/*"U",85*/
{0x10,0x1E,0x11,0x00,0x00,0x13,0x1C,0x10,0x00,0x00,0xE0,0x1C,0x70,0x80,0x00,0x00},/*"V",86*/
{0x1F,0x10,0x00,0x1F,0x00,0x10,0x1F,0x00,0xC0,0x3C,0xE0,0x00,0xE0,0x3C,0xC0,0x00},/*"W",87*/
{0x10,0x18,0x16,0x01,0x01,0x16,0x18,0x10,0x04,0x0C,0x34,0xC0,0xC0,0x34,0x0C,0x04},/*"X",88*/
{0x10,0x1C,0x13,0x00,0x13,0x1C,0x10,0x00,0x00,0x00,0x04,0xFC,0x04,0x00,0x00,0x00},/*"Y",89*/
{0x08,0x10,0x10,0x10,0x13,0x1C,0x10,0x00,0x04,0x1C,0x64,0x84,0x04,0x04,0x18,0x00},/*"Z",90*/
{0x00,0x00,0x00,0x7F,0x40,0x40,0x40,0x00,0x00,0x00,0x00,0xFE,0x02,0x02,0x02,0x00},/*"[",91*/
{0x00,0x30,0x0C,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x60,0x1C,0x03,0x00},/*"\",92*/
{0x00,0x40,0x40,0x40,0x7F,0x00,0x00,0x00,0x00,0x02,0x02,0x02,0xFE,0x00,0x00,0x00},/*"]",93*/
{0x00,0x00,0x20,0x40,0x40,0x40,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"^",94*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01},/*"_",95*/
{0x00,0x40,0x40,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",96*/
{0x00,0x00,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x98,0x24,0x44,0x44,0x44,0xFC,0x04},/*"a",97*/
{0x10,0x1F,0x00,0x01,0x01,0x00,0x00,0x00,0x00,0xFC,0x88,0x04,0x04,0x88,0x70,0x00},/*"b",98*/
{0x00,0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x70,0x88,0x04,0x04,0x04,0x88,0x00},/*"c",99*/
{0x00,0x00,0x00,0x01,0x01,0x11,0x1F,0x00,0x00,0x70,0x88,0x04,0x04,0x08,0xFC,0x04},/*"d",100*/
{0x00,0x00,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0xF8,0x44,0x44,0x44,0x44,0xC8,0x00},/*"e",101*/
{0x00,0x01,0x01,0x0F,0x11,0x11,0x11,0x18,0x00,0x04,0x04,0xFC,0x04,0x04,0x00,0x00},/*"f",102*/
{0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0xD6,0x29,0x29,0x29,0xC9,0x06,0x00},/*"g",103*/
{0x10,0x1F,0x00,0x01,0x01,0x01,0x00,0x00,0x04,0xFC,0x84,0x00,0x00,0x04,0xFC,0x04},/*"h",104*/
{0x00,0x01,0x19,0x19,0x00,0x00,0x00,0x00,0x00,0x04,0x04,0xFC,0x04,0x04,0x00,0x00},/*"i",105*/
{0x00,0x00,0x00,0x01,0x19,0x19,0x00,0x00,0x00,0x03,0x01,0x01,0x01,0xFE,0x00,0x00},/*"j",106*/
{0x10,0x1F,0x00,0x00,0x01,0x01,0x01,0x00,0x04,0xFC,0x24,0x40,0xB4,0x0C,0x04,0x00},/*"k",107*/
{0x00,0x10,0x10,0x1F,0x00,0x00,0x00,0x00,0x00,0x04,0x04,0xFC,0x04,0x04,0x00,0x00},/*"l",108*/
{0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x04,0xFC,0x04,0x00,0xFC,0x04,0x00,0xFC},/*"m",109*/
{0x01,0x01,0x00,0x01,0x01,0x01,0x00,0x00,0x04,0xFC,0x84,0x00,0x00,0x04,0xFC,0x04},/*"n",110*/
{0x00,0x00,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0xF8,0x04,0x04,0x04,0x04,0xF8,0x00},/*"o",111*/
{0x01,0x01,0x00,0x01,0x01,0x00,0x00,0x00,0x01,0xFF,0x85,0x04,0x04,0x88,0x70,0x00},/*"p",112*/
{0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x00,0x00,0x70,0x88,0x04,0x04,0x05,0xFF,0x01},/*"q",113*/
{0x01,0x01,0x01,0x00,0x01,0x01,0x01,0x00,0x04,0x04,0xFC,0x84,0x04,0x00,0x80,0x00},/*"r",114*/
{0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0xCC,0x24,0x24,0x24,0x24,0x98,0x00},/*"s",115*/
{0x00,0x01,0x01,0x07,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0xF8,0x04,0x04,0x00,0x00},/*"t",116*/
{0x01,0x01,0x00,0x00,0x00,0x01,0x01,0x00,0x00,0xF8,0x04,0x04,0x04,0x08,0xFC,0x04},/*"u",117*/
{0x01,0x01,0x01,0x00,0x00,0x01,0x01,0x01,0x00,0x80,0x70,0x0C,0x10,0x60,0x80,0x00},/*"v",118*/
{0x01,0x01,0x00,0x01,0x00,0x01,0x01,0x01,0xF0,0x0C,0x30,0xC0,0x30,0x0C,0xF0,0x00},/*"w",119*/
{0x00,0x01,0x01,0x00,0x01,0x01,0x01,0x00,0x00,0x04,0x8C,0x74,0x70,0x8C,0x04,0x00},/*"x",120*/
{0x01,0x01,0x01,0x00,0x00,0x01,0x01,0x01,0x01,0x81,0x71,0x0E,0x18,0x60,0x80,0x00},/*"y",121*/
{0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x84,0x0C,0x34,0x44,0x84,0x0C,0x00},/*"z",122*/
{0x00,0x00,0x00,0x00,0x01,0x3E,0x40,0x40,0x00,0x00,0x00,0x00,0x00,0xFC,0x02,0x02},/*"{",123*/
{0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00},/*"|",124*/
{0x00,0x40,0x40,0x3E,0x01,0x00,0x00,0x00,0x00,0x02,0x02,0xFC,0x00,0x00,0x00,0x00},/*"}",125*/
{0x00,0x60,0x80,0x80,0x40,0x40,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"~",126*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"",127*/
};

/**************************************************************************************************
 *                                       FUNCTIONS - API
 **************************************************************************************************/
unsigned char SPI_ReadWrite(unsigned char byte);
void OLED_Write_Data(unsigned char Data);
void OLED_Write_Command (unsigned char Data);
void OLED_ConfigIO(void);
void Set_NOP(void);

/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Instruction Setting   Ö¸Áî¼¯
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void OLED_Set_Start_Column(unsigned char d)   //ÉèÖÃ¿ªÊ¼ÁÐ
{
	OLED_Write_Command(0x00+d%16);		// Set Lower Column Start Address for Page Addressing Mode
						//   Default => 0x00
	OLED_Write_Command(0x10+d/16);		// Set Higher Column Start Address for Page Addressing Mode
						//   Default => 0x10
}

void Set_Addressing_Mode(unsigned char d)  //É¨Ãè·½Ê½
{
	OLED_Write_Command(0x20);// Set Memory Addressing Mode
	OLED_Write_Command(d);	//   Default => 0x02
						//     0x00 => Horizontal Addressing Mode
						//     0x01 => Vertical Addressing Mode
						//     0x02 => Page Addressing Mode
}

void Set_Column_Address(unsigned char a, unsigned char b)      //ÁÐµØÖ·
{
	OLED_Write_Command(0x21);		// Set Column Address
	OLED_Write_Command(a);			//   Default => 0x00 (Column Start Address)
	OLED_Write_Command(b);			//   Default => 0x7F (Column End Address)
}


void Set_Page_Address(unsigned char a, unsigned char b)     //Ò³µØÖ·
{
	OLED_Write_Command(0x22);		// Set Page Address
	OLED_Write_Command(a);			//   Default => 0x00 (Page Start Address)
	OLED_Write_Command(b);			//   Default => 0x07 (Page End Address)
}


void Set_Start_Line(unsigned char ddd)            //ÆðÊ¼ÐÐ
{
	OLED_Write_Command(0x40|ddd);	// Set Display Start Line
					    	//   Default => 0x40 (0x00)
}


void Set_Contrast_Control(unsigned char ddd)     //¶Ô±ÈÉèÖÃ
{
	OLED_Write_Command(0x81);		// Set Contrast Control
	OLED_Write_Command(ddd);			//   Default => 0x7F
}


void Set_Charge_Pump(unsigned char ddd)         //???????????????
{
	OLED_Write_Command(0x8D);	// Set Charge Pump
	OLED_Write_Command(0x10|ddd);	//   Default => 0x10
					    	//     0x10 (0x00) => Disable Charge Pump
					    	//     0x14 (0x04) => Enable Charge Pump
}


void Set_Segment_Remap(unsigned char ddd)
{
	OLED_Write_Command(0xA0|ddd);	// Set Segment Re-Map
					    	//   Default => 0xA0
						    //     0xA0 (0x00) => Column Address 0 Mapped to SEG0
						    //     0xA1 (0x01) => Column Address 0 Mapped to SEG127
}


void Set_Entire_Display(unsigned char ddd)      //È«²¿ÏÔÊ¾
{
	OLED_Write_Command(0xA4|ddd);	// Set Entire Display On / Off
						//   Default => 0xA4
						//     0xA4 (0x00) => Normal Display
						//     0xA5 (0x01) => Entire Display On
}


void Set_Inverse_Display(unsigned char ddd)//·´ÏòÏÔÊ¾
{
	OLED_Write_Command(0xA6|ddd);			// Set Inverse Display On/Off
						//   Default => 0xA6
						//     0xA6 (0x00) => Normal Display
						//     0xA7 (0x01) => Inverse Display On
}


void Set_Multiplex_Ratio(unsigned char ddd)         //¶àÑù±ÈÀý
{
	OLED_Write_Command(0xA8);			// Set Multiplex Ratio
	OLED_Write_Command(ddd);			//   Default => 0x3F (1/64 Duty)
}


void Set_Display_On_Off(unsigned char dd)       	//ÏÔÊ¾¿ª¹Ø
{
	OLED_Write_Command(0xAE|dd);	// Set Display On/Off
						//   Default => 0xAE
						//     0xAE (0x00) => Display Off
						//     0xAF (0x01) => Display On
}


void OLED_Set_Start_Page(unsigned char dd)            //ÉèÖÃÆðÊ¼Ò³    ÓÃÓÚÒ³Ñ°Ö·
{
	OLED_Write_Command(0xB0|dd);			// Set Page Start Address for Page Addressing Mode
						//   Default => 0xB0 (0x00)
}


void Set_Common_Remap(unsigned char dd)
{
	OLED_Write_Command(0xC0|dd);	// Set COM Output Scan Direction
						//   Default => 0xC0
						//     0xC0 (0x00) => Scan from COM0 to 63
						//     0xC8 (0x08) => Scan from COM63 to 0
}


void Set_Display_Offset(unsigned char dd)          //²¹³¥ÏÔÊ¾
{
	OLED_Write_Command(0xD3);		// Set Display Offset
	OLED_Write_Command(dd);			//   Default => 0x00
}


void Set_Display_Clock(unsigned char dd)        //ÉèÖÃÏÔÊ¾Ê±ÖÓ
{
	OLED_Write_Command(0xD5);		// Set Display Clock Divide Ratio / Oscillator Frequency
	OLED_Write_Command(dd);			//   Default => 0x80
						//     D[3:0] => Display Clock Divider
						//     D[7:4] => Oscillator Frequency
}


void Set_Precharge_Period(unsigned char dd)       //Ô¤³äµçÖÜÆÚ
{
	OLED_Write_Command(0xD9);	// Set Pre-Charge Period
	OLED_Write_Command(dd);		//   Default => 0x22 (2 Display Clocks [Phase 2] / 2 Display Clocks [Phase 1])
						//     D[3:0] => Phase 1 Period in 1~15 Display Clocks
						//     D[7:4] => Phase 2 Period in 1~15 Display Clocks
}


void Set_Common_Config(unsigned char dd)
{
	OLED_Write_Command(0xDA);	// Set COM Pins Hardware Configuration
	OLED_Write_Command(0x02|dd);	//   Default => 0x12 (0x10)
						//     Alternative COM Pin Configuration
						//     Disable COM Left/Right Re-Map
}


void Set_VCOMH(unsigned char dd)
{
	OLED_Write_Command(0xDB);		// Set VCOMH Deselect Level
	OLED_Write_Command(dd);			//   Default => 0x20 (0.77*VCC)
}


void Set_NOP()           //ÎÞ²Ù×÷  Í£¶Ù
{
	OLED_Write_Command(0xE3);		// Command for No Operation
}


void OLED_setXY(unsigned char X,unsigned char Y)
{

	 OLED_Set_Start_Page(Y);
	 OLED_Set_Start_Column(X);
}


/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Show Regular Pattern (Full Screen)           Õý³£Ä£Ê½ÏÔÊ¾
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void OLED_Fill_RAM(unsigned char Data)     //È«²¿ÏÔÊ¾Îª Data
{
	unsigned char i,j;
	OLED_setXY(0,0);
	for(i=0;i<8;i++)
	{
		for(j=0;j<128;j++)
		{
			OLED_Write_Data(Data);
		}
	}
}

/*=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Show Regular Pattern (Partial or Full Screen)   //¾Ö²¿»òÕßÈ«²¿ÏÔÊ¾Îª Data
//
//    a: Start Page
//    b: End Page
//    c: Start Column
//    d: Total Columns
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void Fill_Block(unsigned char Data, unsigned char a, unsigned char b, unsigned char c, unsigned char d)
{
unsigned char i,j;
	
	for(i=a;i<(b+1);i++)
	{
		OLED_Set_Start_Page(i);
		OLED_Set_Start_Column(c);

		for(j=0;j<d;j++)
		{
			OLED_Write_Data(Data);
		}
	}
}


/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Show Pattern (Partial or Full Screen)         //¾Ö²¿»òÕßÈ«²¿ÏÔÊ¾Îª *Data_Pointer
//
//    a: Start Page
//    b: End Page
//    c: Start Column
//    d: Total Columns  ×ÜÁÐÊý
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void Show_Pattern(unsigned char *Data_Pointer, unsigned char a, unsigned char b, unsigned char c, unsigned char d)
{
unsigned char *Src_Pointer;
unsigned char i,j;

	Src_Pointer=Data_Pointer;
	for(i=a;i<(b+1);i++)
	{
		OLED_Set_Start_Page(i);
		OLED_Set_Start_Column(c);

		for(j=0;j<d;j++)
		{
			OLED_Write_Data(*Src_Pointer);
			Src_Pointer++;
		}
	}
}

/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Vertical / Fade Scrolling (Partial or Full Screen)       ¹ö¶¯ÏÔÊ¾ÉèÖÃ
//
//    a: Scrolling Direction
//       "0x00" (Upward)
//       "0x01" (Downward)
//    b: Set Top Fixed Area     //¶¥²¿ÇøÓòÉèÖÃ¹Ì¶¨
//    c: Set Vertical Scroll Area   //´¹Ö±¹ö¶¯ÇøÓòÉèÖÃ
//    d: Set Numbers of Row Scroll per Step    //ÉèÖÃÃ¿Ò»²½Ò»ÐÐ¹ö¶¯Êý×Ö
//    e: Set Time Interval between Each Scroll Step   //Ã¿Ò»¾íÉè¶¨µÄÊ±¼ä¼ä¸ôµÄ²½Öè
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void Vertical_Scroll(unsigned char a, unsigned char b, unsigned char c, unsigned char d, unsigned char e)
{
  unsigned char i,j;	

	OLED_Write_Command(0xA3);			// Set Vertical Scroll Area
	OLED_Write_Command(b);			//   Default => 0x00 (Top Fixed Area)
	OLED_Write_Command(c);			//   Default => 0x40 (Vertical Scroll Area)

	switch(a)
	{
		case 0:
			for(i=0;i<c;i+=d)
			{
				Set_Start_Line(i);
				for(j=0;j<e;j++)
				{
					;
				}
			}
			break;
		case 1:
			for(i=0;i<c;i+=d)
			{
				Set_Start_Line(c-i);
				for(j=0;j<e;j++)
				{
					;
				}
			}
			break;
	}
	Set_Start_Line(0x00);
}

/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Continuous Horizontal Scrolling (Partial or Full Screen)    Á¬ÐøµÄË®Æ½¹ö¶¯
//
//    a: Scrolling Direction         ÒÆ¶¯·½Ïò
//       "0x00" (Rightward)
//       "0x01" (Leftward)
//    b: Define Start Page Address       ¶¨ÒåÆðÊ¼Ò³µØÖ·
//    c: Define End Page Address         ¶¨Òå½áÊøÒ³µØÖ·
//    d: Set Time Interval between Each Scroll Step in Terms of Frame Frequency
//    e: Delay Time
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void Horizontal_Scroll(unsigned char a, unsigned char b, unsigned char c, unsigned char dd, unsigned char ed)
{
	OLED_Write_Command(0x26|a);			// Horizontal Scroll Setup
	OLED_Write_Command(0x00);			//           => (Dummy Write for First Parameter)
	OLED_Write_Command(b);
	OLED_Write_Command(dd);
	OLED_Write_Command(c);
	OLED_Write_Command(0x2F);			// Activate Scrolling
	my_delayus(ed);
}

/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Continuous Vertical / Horizontal / Diagonal Scrolling (Partial or Full Screen)
//
//    a: Scrolling Direction
//       "0x00" (Vertical & Rightward)
//       "0x01" (Vertical & Leftward)
//    b: Define Start Row Address (Horizontal / Diagonal Scrolling)
//    c: Define End Page Address (Horizontal / Diagonal Scrolling)
//    d: Set Top Fixed Area (Vertical Scrolling)
//    e: Set Vertical Scroll Area (Vertical Scrolling)
//    f: Set Numbers of Row Scroll per Step (Vertical / Diagonal Scrolling)
//    g: Set Time Interval between Each Scroll Step in Terms of Frame Frequency
//    h: Delay Time
//    * d+e must be less than or equal to the Multiplex Ratio...
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void Continuous_Scroll(unsigned char a, unsigned char b, unsigned char c, unsigned char dd, unsigned char ed, unsigned char f, unsigned char g, unsigned char h)
{
	OLED_Write_Command(0xA3);			// Set Vertical Scroll Area
	OLED_Write_Command(dd);			//   Default => 0x00 (Top Fixed Area)
	OLED_Write_Command(ed);			//   Default => 0x40 (Vertical Scroll Area)

	OLED_Write_Command(0x29+a);			// Continuous Vertical & Horizontal Scroll Setup
	OLED_Write_Command(0x00);			//           => (Dummy Write for First Parameter)
	OLED_Write_Command(b);
	OLED_Write_Command(g);
	OLED_Write_Command(c);
	OLED_Write_Command(f);
	OLED_Write_Command(0x2F);			// Activate Scrolling
	my_delayus(h);
}

/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Deactivate Scrolling (Full Screen)   ¹Ø±Õ¹ö¶¯
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void Deactivate_Scroll()
{
	OLED_Write_Command(0x2E);			// Deactivate Scrolling
}

/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//  Sleep Mode   Ë¯ÃßÄ£Ê½
//
//    "0x00" Enter Sleep Mode   ½øÈëË¯ÃßÄ£Ê½
//    "0x01" Exit Sleep Mode   ÍË³öË¯ÃßÄ£Ê½
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*/
void Sleep(unsigned char a)
{
	switch(a)
	{
		case 0:
			Set_Display_On_Off(0x00);
			Set_Entire_Display(0x01);
			break;
		case 1:
			Set_Entire_Display(0x00);
			Set_Display_On_Off(0x01);
			break;
	}
}

		   			

void OLED_Clear(void)
{
	  OLED_Fill_RAM(0);
}


void OLED_Checkerboard()
{
	unsigned char i,j;

	OLED_setXY(0,0);
	for(i=0;i<8;i++)
	{
		for(j=0;j<64;j++)        //¼ì²â
		{
			OLED_Write_Data(0x55);
			OLED_Write_Data(0xAA);
		}
	}
}


/****************************************************************************************************
----------------ÏÔÊ¾X£¬Y×ø±ê´¦µÄÒ»¸ö×Ö·û¡£Ò»ÐÐ¿ÉÒÔÏÔÊ¾16¸ö×Ö·û¡£XÎª0µ½15£¬YÎª0µ½3
*****************************************************************************************************
*º¯ÊýÃû³Æ:	OLED_Display_Char
*º¯Êý¹¦ÄÜ:	ÏÔÊ¾X£¬Y×ø±ê´¦µÄÒ»¸ö×Ö·û(16*8)
*ÊäÈë²ÎÊý:	X---ºá×ø±ê
*				Y---×Ý×ø±ê
*				cn---×Ö·û
*Êä³ö²ÎÊý:	void
*±¸×¢:		Ò»ÐÐ¿ÉÒÔÏÔÊ¾16¸ö×Ö·û¡£XÎª0µ½120£¬YÎª0µ½3
****************************************************************************************************/

void OLED_Display_Char(unsigned char x,unsigned char y,char c)	 
{
	unsigned char i;
	OLED_setXY(x,7-y);
	for(i=0;i<8;i++)
		OLED_Write_Data(*(*(OLED_HiASCII+c)+i));
	
	OLED_setXY(x,6-y);
	for(i=8;i<16;i++)
		OLED_Write_Data(*(*(OLED_HiASCII+c)+i));
}


/**************************************************************************************************
 * @fn      OLED_Display_String
 *
 * @brief   ÏÔÊ¾×Ö·û´®
 *
 * @param  	GBCode  	×Ö·û´®
 *          x,y		Î»ÖÃ
 *					
 * @return  None
 **************************************************************************************************/
void OLED_Display_String(unsigned char x,unsigned char y,char* str)
{
	while(*str)
	{
		OLED_Display_Char(x,y,*str++);
		x=x+8;
	}
}


/**************************************************************************************************
 * @fn      OLED_Display_Format
 *
 * @brief   ¸ñÊ½»¯Êä³ö×Ö·û´®
 *
 * @param   x,y		Î»ÖÃ
 *				format  	¸ñÊ½»¯×Ö·û
 * @return  None
 **************************************************************************************************/
void OLED_Display_Format(unsigned char x,unsigned char y,const char* format,...)
{
	va_list ap;
	char string[64]={0};
	va_start(ap,format);
	vsnprintf(string,64,format,ap);
	va_end(ap);
	OLED_Display_String(x,y,string);
}

/**************************************************************************************************
 *                                    HARDWARE LCD
 **************************************************************************************************/
void OLED_ConfigIO(void)
{
	SPI_InitTypeDef  SPI_InitStructure;
	GPIO_InitTypeDef GPIO_InitStructure;

	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA|RCC_APB2Periph_GPIOC|RCC_APB2Periph_AFIO|RCC_APB2Periph_SPI1,ENABLE);

	GPIO_InitStructure.GPIO_Pin=GPIO_Pin_5|GPIO_Pin_6|GPIO_Pin_7;
	GPIO_InitStructure.GPIO_Mode=GPIO_Mode_AF_PP;
	GPIO_InitStructure.GPIO_Speed=GPIO_Speed_50MHz;
	GPIO_Init(GPIOA,&GPIO_InitStructure);

	GPIO_InitStructure.GPIO_Pin=GPIO_Pin_4|GPIO_Pin_5;
	GPIO_InitStructure.GPIO_Mode=GPIO_Mode_Out_PP;
	GPIO_Init(GPIOC,&GPIO_InitStructure);

	GPIO_InitStructure.GPIO_Pin=GPIO_Pin_4;
	GPIO_Init(GPIOA,&GPIO_InitStructure);

	OLED_CS_HIGH();
	FONT_CS_HIGH();

	SPI_InitStructure.SPI_Direction=SPI_Direction_2Lines_FullDuplex;
	SPI_InitStructure.SPI_Mode=SPI_Mode_Master;
	SPI_InitStructure.SPI_DataSize=SPI_DataSize_8b;
	SPI_InitStructure.SPI_CPOL=SPI_CPOL_High;
	SPI_InitStructure.SPI_CPHA=SPI_CPHA_2Edge;
	SPI_InitStructure.SPI_NSS=SPI_NSS_Soft;
	SPI_InitStructure.SPI_BaudRatePrescaler=SPI_BaudRatePrescaler_16;
	SPI_InitStructure.SPI_FirstBit=SPI_FirstBit_MSB;
	SPI_InitStructure.SPI_CRCPolynomial=7;
	SPI_Init(SPI1,&SPI_InitStructure);

	SPI_Cmd(SPI1,ENABLE);
}

/**************************************************************************************************
 * @fn      OLEDInit
 *
 * @brief   Initilize OLED Driver.
 *
 * @param   None
 *
 * @return  None
 **************************************************************************************************/
void OLED_Init(void)
{
	/* Initialize LCD IO lines */
	OLED_ConfigIO();
	
	Set_Display_On_Off(0x00);			// Display Off (0x00/0x01)
	Set_Display_Clock(0x80);			// Set Clock as 100 Frames/Sec
	Set_Multiplex_Ratio(0x3F);			// 1/64 Duty (0x0F~0x3F)
	Set_Display_Offset(0x00);	  		// Shift Mapping RAM Counter (0x00~0x3F)
	Set_Start_Line(0x00);		    	// Set Mapping RAM Display Start Line (0x00~0x3F)
	Set_Charge_Pump(0x04);		    	// Enable Embedded DC/DC Converter (0x00/0x04)
	Set_Addressing_Mode(0x00);		    // Set Page Addressing Mode (0x00/0x01/0x02)
	Set_Segment_Remap(0x01);		    // Set SEG/Column Mapping (0x00/0x01)
	Set_Common_Remap(0x00);		    	// Set COM/Row Scan Direction (0x00/0x08)  ////////////////
	Set_Common_Config(0x10);	    	// Set Sequential Configuration (0x00/0x10)
	Set_Contrast_Control(0xFF);	// Set SEG Output Current
	Set_Precharge_Period(0xF1);			// Set Pre-Charge as 15 Clocks & Discharge as 1 Clock
	Set_VCOMH(0x40);					// Set VCOM Deselect Level
	Set_Entire_Display(0x00);			// Disable Entire Display On (0x00/0x01)
	Set_Inverse_Display(0x00);			// Disable Inverse Display On (0x00/0x01)
	

	OLED_Fill_RAM(0x00);				    	// Clear Screen

	Set_Display_On_Off(0x01);	    	// Display On (0x00/0x01)
}


/**************************************************************************************************
 * @fn      OLED_Write_Command
 *
 * @brief   Ð´¿ØÖÆÃüÁî
 *
 * @param   Data		Êý¾Ý
 *					
 * @return  None
 **************************************************************************************************/
void OLED_Write_Command (unsigned char Data)
{
	OLED_CS_LOW();
	OLED_DC_LOW();
	SPI_ReadWrite(Data);
	OLED_CS_HIGH();
}

/**************************************************************************************************
 * @fn      OLED_Write_Data
 *
 * @brief   Ð´Êý¾Ý
 *
 * @param   Data		Êý¾Ý
 *					
 * @return  None
 **************************************************************************************************/
void OLED_Write_Data(unsigned char Data)
{
	OLED_CS_LOW();
	OLED_DC_HIGH();
	SPI_ReadWrite(Data);
	OLED_CS_HIGH();
}


unsigned char SPI_ReadWrite(unsigned char byte)
{
	while(SPI_I2S_GetFlagStatus(SPI1,SPI_I2S_FLAG_TXE)==RESET);
	SPI_I2S_SendData(SPI1,byte);
	while(SPI_I2S_GetFlagStatus(SPI1,SPI_I2S_FLAG_RXNE)==RESET);
	return SPI_I2S_ReceiveData(SPI1);
}
